<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>è€ç”Ÿå¸¸è°ˆcategoryå¢åŠ å±æ€§çš„å‡ ç§æ“ä½œ | JungHsu&#39;s Blog</title>

  
  <meta name="author" content="John Doe">
  

  
  <meta name="description" content="å‰è¨€ æ—¥å¸¸å¼€å‘ä¸­ï¼Œä¸ºä¸€ä¸ªå·²æœ‰çš„ç±»(æ¯”å¦‚è¯´ä¸æƒ³å½±å“å…¶æ–‡ä»¶ç»“æ„)ã€ç¬¬ä¸‰æ–¹åº“æä¾›çš„ç±»å¢åŠ å‡ ä¸ªpropertyï¼Œå·²ç»æ˜¯ååˆ†å¸¸è§ä¸”éœ€è¦çš„æ“ä½œäº†ï¼Œæœ‰äººä¼šå•ç‹¬èµ·è‰ä¸€ä»½category.mæ–‡ä»¶ï¼Œä¹Ÿæœ‰äººç›´æ¥ç»§æ‰¿ï¼Œåƒæˆ‘ä¸€èˆ¬ä¼šç”¨categoryï¼Œä¸€æ˜¯èƒ½å‡å°‘ç±»æ–‡ä»¶çš„æ•°é‡æé«˜ç¼–è¯‘é€Ÿåº¦ï¼ŒäºŒä¹Ÿæ˜¯ä¸ºäº†ä»£ç ç»“æ„æ›´åŠ æ¸…æ™°ã€‚
 è¿™ç¯‡æ–‡ç« ">
  

  
  
  <meta name="keywords" content="">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="è€ç”Ÿå¸¸è°ˆcategoryå¢åŠ å±æ€§çš„å‡ ç§æ“ä½œ"/>

  <meta property="og:site_name" content="JungHsu&#39;s Blog"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="JungHsu&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">JungHsu&#39;s Blog</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">ä¸»é¡µ</a></li>
      
        <li><a href="/archives">å½’æ¡£</a></li>
      
        <li><a href="/about">å…³äº</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>è€ç”Ÿå¸¸è°ˆcategoryå¢åŠ å±æ€§çš„å‡ ç§æ“ä½œ</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2017/12/07/è€ç”Ÿå¸¸è°ˆcategoryå¢åŠ å±æ€§çš„å‡ ç§æ“ä½œ/" rel="bookmark">
        <time class="entry-date published" datetime="2017-12-07T15:35:15.000Z">
          2017-12-07
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p> æ—¥å¸¸å¼€å‘ä¸­ï¼Œä¸ºä¸€ä¸ªå·²æœ‰çš„ç±»(æ¯”å¦‚è¯´ä¸æƒ³å½±å“å…¶æ–‡ä»¶ç»“æ„)ã€ç¬¬ä¸‰æ–¹åº“æä¾›çš„ç±»å¢åŠ å‡ ä¸ªpropertyï¼Œå·²ç»æ˜¯ååˆ†å¸¸è§ä¸”éœ€è¦çš„æ“ä½œäº†ï¼Œæœ‰äººä¼šå•ç‹¬èµ·è‰ä¸€ä»½category.mæ–‡ä»¶ï¼Œä¹Ÿæœ‰äººç›´æ¥ç»§æ‰¿ï¼Œåƒæˆ‘ä¸€èˆ¬ä¼šç”¨categoryï¼Œä¸€æ˜¯èƒ½å‡å°‘ç±»æ–‡ä»¶çš„æ•°é‡æé«˜ç¼–è¯‘é€Ÿåº¦ï¼ŒäºŒä¹Ÿæ˜¯ä¸ºäº†ä»£ç ç»“æ„æ›´åŠ æ¸…æ™°ã€‚</p>
<p> è¿™ç¯‡æ–‡ç« æ˜¯ç”¨æ¥å†™Categoryçš„è¿›è¡Œå±æ€§æ‰©å±•çš„è¡Œä¸ºçš„ï¼Œæ‰€ä»¥æˆ‘è¿˜æ˜¯è¨€å½’æ­£ä¼ ï¼Œé¦–å…ˆï¼Œæˆ‘è¦é˜è¿°ä¸€ä¸‹ç›®å‰æ¯”è¾ƒä¸»æµçš„å‡ ä¸ªå±æ€§æ‰©å±•å½¢å¼ï¼Œå†å¾€ä¸‹è¿›è¡Œåˆ†æ:</p>
<ol>
<li>åˆ©ç”¨ objc_setAssociatedObjectå‡½æ•°è¿›è¡Œå¯¹è±¡çš„è”åˆã€‚</li>
<li>åˆ©ç”¨ class_addProperty å‡½æ•°è¿›è¡Œç±»å±æ€§çš„æ‰©å±•</li>
<li><p>é€šè¿‡å†…éƒ¨åˆ›å»ºä¸€ä¸ªå…¶ä»–å¯¹è±¡(æ¯”å¦‚å­—å…¸),é€šè¿‡é‡å†™æœ¬å¯¹è±¡setå’Œgetæˆ–è€…æ¶ˆæ¯è½¬å‘ã€‚</p>
<p>ä¸‹é¢å¯¹è¿™ä¸‰ç§å¸¸ç”¨æ–¹æ³•è¿›è¡Œåˆ†æï¼Œå…¶å®å¸¸è§çš„éƒ½æ˜¯å‰é¢ä¸¤ç§ï¼Œç¬¬ä¸‰ç§ä¹Ÿæ˜¯æ¯”è¾ƒéä¸»æµã€‚åœ¨åˆ†æè¿™ä¸‰ç§ä¹‹å‰ï¼Œæˆ‘è¦è°ˆä¸€ä¸‹ä¸ºä»€ä¹ˆä¸èƒ½ç”¨ class_addIvar å‡½æ•°ã€‚</p>
</li>
</ol>
<ul>
<li>class_addIvar å‡½æ•°<blockquote>
<p>åœ¨è‹¹æœæ–‡æ¡£ä¸­ï¼Œå¯¹ class_addIvar å‡½æ•°æœ‰ä¸‹é¢ä¸€æ®µè¯:</p>
</blockquote>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">This function may only be called after objc_allocateClassPair(_:_:_:) and before objc_registerClassPair(_:). Adding an instance variable to an existing class is not supported.</span><br><span class="line">The class must not be a metaclass. Adding an instance variable to a metaclass is not supported.</span><br><span class="line"></span><br><span class="line">è¿™ä¸ªåŠŸèƒ½åªèƒ½åœ¨ objc_allocateClassPair(_:_:_:) ä¹‹åå’Œ objc_registerClassPair(_:) ä¹‹å‰è°ƒç”¨ã€‚ä¸æ”¯æŒå°†å®ä¾‹å˜é‡æ·»åŠ åˆ°ç°æœ‰çš„ç±»ã€‚</span><br><span class="line">è¯¥ç±»ä¸èƒ½æ˜¯å…ƒç±»ã€‚ä¸æ”¯æŒå°†å®ä¾‹å˜é‡æ·»åŠ åˆ°å…ƒç±»ã€‚</span><br></pre></td></tr></table></figure>
<p> æ–‡æ¡£æ˜¯è¯´ä¸èƒ½å°†æ­¤å‡½æ•°ç”¨äºå·²æœ‰çš„ç±»ï¼Œå¿…é¡»æ˜¯åŠ¨æ€åˆ›å»ºçš„ç±»ï¼Œä¸ºäº†èƒ½å¤ŸçŸ¥é“ä¸ºä½•ä¼šè¿™æ ·ï¼Œæˆ‘ä»¬éœ€è¦ç¿»é˜…ä¸€ä¸‹è‹¹æœå¼€æºçš„ runtime æºç ã€‚</p>
<ol>
<li><p>é¦–å…ˆçœ‹ä¸€ä¸‹å…³äº objc_allocateClassPair å‡½æ•°çš„ä»£ç å®ç°:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">å»é™¤å¹²æ‰°ä»£ç ï¼Œæˆ‘ä»¬å¯»æ‰¾åˆ°ä¸‹é¢çš„å‡½æ•°è°ƒç”¨é“¾æ¡:</span><br><span class="line">objc_allocateClassPair -&gt; objc_initializeClassPair_internal</span><br><span class="line"></span><br><span class="line">// ä¸‹é¢çš„ä»£ç å·²ç»è¢«æˆ‘å¤§éƒ¨åˆ†å‰”é™¤ï¼Œåªç•™ä¸‹æˆ‘ä»¬åˆ†ææ‰€éœ€è¦ç”¨åˆ°çš„ä»£ç </span><br><span class="line">static void objc_initializeClassPair_internal(Class superclass, const char *name, Class cls, Class meta)</span><br><span class="line">&#123;</span><br><span class="line">    // Set basic info</span><br><span class="line"></span><br><span class="line">    cls-&gt;data()-&gt;flags = RW_CONSTRUCTING | RW_COPIED_RO | RW_REALIZED | RW_REALIZING;</span><br><span class="line">    meta-&gt;data()-&gt;flags = RW_CONSTRUCTING | RW_COPIED_RO | RW_REALIZED | RW_REALIZING;</span><br><span class="line">    cls-&gt;data()-&gt;version = 0;</span><br><span class="line">    meta-&gt;data()-&gt;version = 7;</span><br><span class="line">    </span><br><span class="line">    // RW_CONSTRUCTING ç±»å·²åˆ†é…ä½†è¿˜æœªæ³¨å†Œ</span><br><span class="line">    // RW_COPIED_RO class_rw_t-&gt;ro æ¥è‡ª class_ro_t ç»“æ„çš„å¤åˆ¶</span><br><span class="line">    // RW_REALIZED //  class_t-&gt;data çš„ç»“æ„ä¸º class_rw_t</span><br><span class="line">    // RW_REALIZING // ç±»å·²å¼€å§‹åˆ†é…ï¼Œä½†å¹¶æœªå®Œæˆ</span><br><span class="line">    // ä»¥ä¸Šå‡ ä¸ªå®éƒ½æ˜¯å¯¹æ–°ç±»çš„class_rw_tç»“æ„è®¾ç½®åŸºæœ¬ä¿¡æ¯</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¸‹é¢æ˜¯class_addIvarçš„ä¸æˆ‘åˆ†ææ‰€éœ€è¦çš„å®ç°ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// æ— å…³ä»£ç å·²ç»å‰”é™¤</span><br><span class="line">BOOL </span><br><span class="line">class_addIvar(Class cls, const char *name, size_t size, </span><br><span class="line">              uint8_t alignment, const char *type)</span><br><span class="line">&#123;</span><br><span class="line">    if (!cls) return NO;</span><br><span class="line"></span><br><span class="line">    if (!type) type = &quot;&quot;;</span><br><span class="line">    if (name  &amp;&amp;  0 == strcmp(name, &quot;&quot;)) name = nil;</span><br><span class="line"></span><br><span class="line">    rwlock_writer_t lock(runtimeLock);</span><br><span class="line"></span><br><span class="line">    assert(cls-&gt;isRealized());</span><br><span class="line"></span><br><span class="line">    // No class variables</span><br><span class="line">    if (cls-&gt;isMetaClass()) &#123;</span><br><span class="line">        return NO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Can only add ivars to in-construction classes.</span><br><span class="line">    if (!(cls-&gt;data()-&gt;flags &amp; RW_CONSTRUCTING)) &#123;</span><br><span class="line">        return NO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">// é‡ç‚¹åœ¨è¿™æœ€åä¸€å¥ï¼Œå‰é¢æˆ‘ä»¬å·²ç»çœ‹åˆ° objc_allocateClassPair å‡½æ•°æ‰€åˆ†é…çš„æ–°ç±»çš„flagsä½ä¿¡æ¯ï¼Œåœ¨æ­¤å¤„ &amp; RW_CONSTRUCTINGï¼Œå¿…å®šä¸ºçœŸï¼Œå–ååè·³è¿‡å¤§æ‹¬å·å‘ä¸‹æ‰§è¡Œã€‚</span><br></pre></td></tr></table></figure>
</li>
<li><p>å·²ç»å­˜åœ¨çš„ç±»ï¼Œç»è¿‡æµ‹è¯•ï¼Œflagä½ä¸º RW_REALIZED|RW_REALIZING,è®¾ç½®å‡½æ•°å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">static Class realizeClass(Class cls)</span><br><span class="line">&#123;</span><br><span class="line">    runtimeLock.assertWriting();</span><br><span class="line"></span><br><span class="line">    const class_ro_t *ro;</span><br><span class="line">    class_rw_t *rw;</span><br><span class="line">    Class supercls;</span><br><span class="line">    Class metacls;</span><br><span class="line">    bool isMeta;</span><br><span class="line">    </span><br><span class="line">    if (!cls) return nil;</span><br><span class="line">    if (cls-&gt;isRealized()) return cls;</span><br><span class="line">    assert(cls == remapClass(cls));</span><br><span class="line"></span><br><span class="line">    // fixme verify class is not in an un-dlopened part of the shared cache?</span><br><span class="line"></span><br><span class="line">    ro = (const class_ro_t *)cls-&gt;data();</span><br><span class="line">    if (ro-&gt;flags &amp; RO_FUTURE) &#123;</span><br><span class="line">        // This was a future class. rw data is already allocated.</span><br><span class="line">        rw = cls-&gt;data();</span><br><span class="line">        ro = cls-&gt;data()-&gt;ro;</span><br><span class="line">        cls-&gt;changeInfo(RW_REALIZED|RW_REALIZING, RW_FUTURE);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        // Normal class. Allocate writeable class data.</span><br><span class="line">        rw = (class_rw_t *)calloc(sizeof(class_rw_t), 1);</span><br><span class="line">        rw-&gt;ro = ro;</span><br><span class="line">        rw-&gt;flags = RW_REALIZED|RW_REALIZING;</span><br><span class="line">        cls-&gt;setData(rw);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥åœ¨ç»è¿‡æ¡ä»¶ !((RW_REALIZED | RW_REALIZING) &amp; RW_CONSTRUCTING) æ—¶è¿”å›NOã€‚</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="gt-ä»¥ä¸Šä¾¿æ˜¯å¯¹å·²æœ‰ç±»ä¸èƒ½ä½¿ç”¨-class-addIvar-å‡½æ•°çš„åˆ†æ"><a href="#gt-ä»¥ä¸Šä¾¿æ˜¯å¯¹å·²æœ‰ç±»ä¸èƒ½ä½¿ç”¨-class-addIvar-å‡½æ•°çš„åˆ†æ" class="headerlink" title="&gt; ä»¥ä¸Šä¾¿æ˜¯å¯¹å·²æœ‰ç±»ä¸èƒ½ä½¿ç”¨ class_addIvar å‡½æ•°çš„åˆ†æ"></a>&gt; ä»¥ä¸Šä¾¿æ˜¯å¯¹å·²æœ‰ç±»ä¸èƒ½ä½¿ç”¨ class_addIvar å‡½æ•°çš„åˆ†æ</h2><h5 id="å¥½äº†ï¼Œå›åˆ°çœŸæ­£çš„è¯é¢˜ï¼Œå¯¹ä¸Šé¢ä¸‰ç§æ“ä½œçš„åˆ†æ"><a href="#å¥½äº†ï¼Œå›åˆ°çœŸæ­£çš„è¯é¢˜ï¼Œå¯¹ä¸Šé¢ä¸‰ç§æ“ä½œçš„åˆ†æ" class="headerlink" title="å¥½äº†ï¼Œå›åˆ°çœŸæ­£çš„è¯é¢˜ï¼Œå¯¹ä¸Šé¢ä¸‰ç§æ“ä½œçš„åˆ†æ:"></a>å¥½äº†ï¼Œå›åˆ°çœŸæ­£çš„è¯é¢˜ï¼Œå¯¹ä¸Šé¢ä¸‰ç§æ“ä½œçš„åˆ†æ:</h5><ul>
<li>objc_setAssociatedObject <blockquote>
<p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ¨categoryä¸­ä½¿ç”¨propertyï¼Œå¯ä»¥ç”Ÿæˆsetå’Œgetçš„æ–¹æ³•å£°æ˜ï¼ŒåŸå› åœ¨æ­¤ä¸åšåˆ†æï¼Œä¸€èˆ¬ä¸ºäº†æ–¹ä¾¿çš„è°ƒç”¨ï¼Œæˆ‘ä»¬éƒ½ä¼šå†™ä¸Špropertyï¼Œå…³é”®åœ¨äºæ²¡æœ‰setå’Œgetçš„å®ç°ï¼Œäºæ˜¯å°±ä¼šæœ‰ä¸‹é¢è¿™æ ·çš„ä»£ç :</p>
</blockquote>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">static void *key = &quot;key&quot;;</span><br><span class="line">@implementation Person (Extra)</span><br><span class="line"></span><br><span class="line">// æ­¤å¤„ä¸è€ƒè™‘è¯»å†™é”çš„é—®é¢˜</span><br><span class="line">- (void)setName:(NSString *)name&#123;</span><br><span class="line">    objc_setAssociatedObject(self, key, name, OBJC_ASSOCIATION_COPY_NONATOMIC);</span><br><span class="line">&#125;</span><br><span class="line">- (NSString *)name&#123;</span><br><span class="line">    return objc_getAssociatedObject(self, key);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h6 id="ä¸Šé¢çš„-objc-setAssociatedObject-å‡½æ•°å†…éƒ¨çš„è°ƒç”¨é“¾æ¡å¦‚ä¸‹"><a href="#ä¸Šé¢çš„-objc-setAssociatedObject-å‡½æ•°å†…éƒ¨çš„è°ƒç”¨é“¾æ¡å¦‚ä¸‹" class="headerlink" title="ä¸Šé¢çš„ objc_setAssociatedObject å‡½æ•°å†…éƒ¨çš„è°ƒç”¨é“¾æ¡å¦‚ä¸‹:"></a>ä¸Šé¢çš„ objc_setAssociatedObject å‡½æ•°å†…éƒ¨çš„è°ƒç”¨é“¾æ¡å¦‚ä¸‹:</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">objc_setAssociatedObject -&gt; objc_setAssociatedObject_non_gc -&gt; _object_set_associative_reference</span><br><span class="line"></span><br><span class="line">// å…¶ä¸­ä¸»è¦æ“ä½œéƒ½åœ¨ _object_set_associative_reference å‡½æ•°ä¸­ï¼Œå†…éƒ¨å®ç°ç±»ä¼¼ä¸€èˆ¬å±æ€§çš„setå®ç°(ä¿ç•™æ–°å€¼ï¼Œé‡Šæ”¾æ—§å€¼)ï¼Œåœ¨æ­¤æˆ‘ä»¬ä¸è¿›è¡Œæ·±ç©¶ï¼Œå…·ä½“å¯ä»¥å‚è€ƒä¸šå†…å¤§ä½¬çš„åšå®¢æ–‡ç« ã€‚</span><br></pre></td></tr></table></figure>
<h6 id="è¿™ç§æ“ä½œå¾ˆç›´è§‚çš„è¡¨è¾¾äº†æˆ‘ä»¬çš„éœ€è¦ï¼Œä¸”APIååˆ†å‹å¥½ï¼Œä»…ä»…æ˜¯å¯¹äº-weak-ç­–ç•¥æˆ‘ä»¬éœ€è¦è‡ªå·±è®¾è®¡ä¸€ä¸ªã€‚"><a href="#è¿™ç§æ“ä½œå¾ˆç›´è§‚çš„è¡¨è¾¾äº†æˆ‘ä»¬çš„éœ€è¦ï¼Œä¸”APIååˆ†å‹å¥½ï¼Œä»…ä»…æ˜¯å¯¹äº-weak-ç­–ç•¥æˆ‘ä»¬éœ€è¦è‡ªå·±è®¾è®¡ä¸€ä¸ªã€‚" class="headerlink" title="è¿™ç§æ“ä½œå¾ˆç›´è§‚çš„è¡¨è¾¾äº†æˆ‘ä»¬çš„éœ€è¦ï¼Œä¸”APIååˆ†å‹å¥½ï¼Œä»…ä»…æ˜¯å¯¹äº weak ç­–ç•¥æˆ‘ä»¬éœ€è¦è‡ªå·±è®¾è®¡ä¸€ä¸ªã€‚"></a>è¿™ç§æ“ä½œå¾ˆç›´è§‚çš„è¡¨è¾¾äº†æˆ‘ä»¬çš„éœ€è¦ï¼Œä¸”APIååˆ†å‹å¥½ï¼Œä»…ä»…æ˜¯å¯¹äº weak ç­–ç•¥æˆ‘ä»¬éœ€è¦è‡ªå·±è®¾è®¡ä¸€ä¸ªã€‚</h6><h6 id="å¹¶ä¸”è¿™ç§æ“ä½œçš„å¥½å¤„æ˜¯æˆ‘ä»¬æ— éœ€å…³ç³»å…³è”å¯¹è±¡çš„å£°æ˜å‘¨æœŸï¼Œå› ä¸ºå’Œæ™®é€šçš„å±æ€§ä¸€æ ·ï¼Œä¼šéšç€å®¿ä¸»å¯¹è±¡çš„é‡Šæ”¾è€Œé‡Šæ”¾-å…·ä½“å¯ä»¥çœ‹ä»¥ä¸‹ä»£ç "><a href="#å¹¶ä¸”è¿™ç§æ“ä½œçš„å¥½å¤„æ˜¯æˆ‘ä»¬æ— éœ€å…³ç³»å…³è”å¯¹è±¡çš„å£°æ˜å‘¨æœŸï¼Œå› ä¸ºå’Œæ™®é€šçš„å±æ€§ä¸€æ ·ï¼Œä¼šéšç€å®¿ä¸»å¯¹è±¡çš„é‡Šæ”¾è€Œé‡Šæ”¾-å…·ä½“å¯ä»¥çœ‹ä»¥ä¸‹ä»£ç " class="headerlink" title="å¹¶ä¸”è¿™ç§æ“ä½œçš„å¥½å¤„æ˜¯æˆ‘ä»¬æ— éœ€å…³ç³»å…³è”å¯¹è±¡çš„å£°æ˜å‘¨æœŸï¼Œå› ä¸ºå’Œæ™®é€šçš„å±æ€§ä¸€æ ·ï¼Œä¼šéšç€å®¿ä¸»å¯¹è±¡çš„é‡Šæ”¾è€Œé‡Šæ”¾,å…·ä½“å¯ä»¥çœ‹ä»¥ä¸‹ä»£ç :"></a>å¹¶ä¸”è¿™ç§æ“ä½œçš„å¥½å¤„æ˜¯æˆ‘ä»¬æ— éœ€å…³ç³»å…³è”å¯¹è±¡çš„å£°æ˜å‘¨æœŸï¼Œå› ä¸ºå’Œæ™®é€šçš„å±æ€§ä¸€æ ·ï¼Œä¼šéšç€å®¿ä¸»å¯¹è±¡çš„é‡Šæ”¾è€Œé‡Šæ”¾,å…·ä½“å¯ä»¥çœ‹ä»¥ä¸‹ä»£ç :</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">dealloc -&gt; _objc_rootDealloc -&gt; rootDealloc -&gt; object_dispose -&gt; objc_destructInstance</span><br><span class="line">// å¤§éƒ¨åˆ†é‡Šæ”¾æ“ä½œåœ¨ objc_destructInstance å‡½æ•°ä¸­å®Œæˆ</span><br><span class="line"></span><br><span class="line">// ä¸‹é¢æ˜¯ objc_destructInstance å‡½æ•°çš„å®ç°ä»£ç </span><br><span class="line">void *objc_destructInstance(id obj) </span><br><span class="line">&#123;</span><br><span class="line">    if (obj) &#123;</span><br><span class="line">        // Read all of the flags at once for performance.</span><br><span class="line">        bool cxx = obj-&gt;hasCxxDtor();</span><br><span class="line">        bool assoc = !UseGC &amp;&amp; obj-&gt;hasAssociatedObjects();</span><br><span class="line">        bool dealloc = !UseGC;</span><br><span class="line"></span><br><span class="line">        // This order is important.</span><br><span class="line">        // å†…éƒ¨é€šè¿‡C++çš„ææ„å‡½æ•°è¿›è¡Œå¯¹è±¡å±æ€§çš„é‡Šæ”¾ï¼Œå…·ä½“å¯çœ‹sunnyå¤§ç¥çš„åšæ–‡</span><br><span class="line">        if (cxx) object_cxxDestruct(obj);</span><br><span class="line">        // æ­¤å¤„ä¼šç§»é™¤æ‰€æœ‰çš„å…³è”å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯objc_setAssociatedObject å‡½æ•°æ‰€è®¾ç½®ä¸Šå»çš„å¯¹è±¡</span><br><span class="line">        if (assoc) _object_remove_assocations(obj);</span><br><span class="line">        // æ¸…ç©ºå¼•ç”¨è®¡æ•°ä¸weakè¡¨</span><br><span class="line">        if (dealloc) obj-&gt;clearDeallocating();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="å½“ç„¶ä¹Ÿæœ‰ä¸è¶³ä¹‹å¤„ï¼Œåˆ©ç”¨-objc-setAssociatedObject-ç”Ÿæˆçš„å…³è”å¯¹è±¡æ— æ³•ç›´æ¥åˆ©ç”¨ç›®å‰ä¸»æµçš„Jsonè½¬Modelåº“-åŸå› æ˜¯æ— æ³•åœ¨ivaråŠpropertyä¸­éå†å‡ºæ¥-ã€‚"><a href="#å½“ç„¶ä¹Ÿæœ‰ä¸è¶³ä¹‹å¤„ï¼Œåˆ©ç”¨-objc-setAssociatedObject-ç”Ÿæˆçš„å…³è”å¯¹è±¡æ— æ³•ç›´æ¥åˆ©ç”¨ç›®å‰ä¸»æµçš„Jsonè½¬Modelåº“-åŸå› æ˜¯æ— æ³•åœ¨ivaråŠpropertyä¸­éå†å‡ºæ¥-ã€‚" class="headerlink" title="å½“ç„¶ä¹Ÿæœ‰ä¸è¶³ä¹‹å¤„ï¼Œåˆ©ç”¨ objc_setAssociatedObject ç”Ÿæˆçš„å…³è”å¯¹è±¡æ— æ³•ç›´æ¥åˆ©ç”¨ç›®å‰ä¸»æµçš„Jsonè½¬Modelåº“(åŸå› æ˜¯æ— æ³•åœ¨ivaråŠpropertyä¸­éå†å‡ºæ¥)ã€‚"></a>å½“ç„¶ä¹Ÿæœ‰ä¸è¶³ä¹‹å¤„ï¼Œåˆ©ç”¨ objc_setAssociatedObject ç”Ÿæˆçš„å…³è”å¯¹è±¡æ— æ³•ç›´æ¥åˆ©ç”¨ç›®å‰ä¸»æµçš„Jsonè½¬Modelåº“(åŸå› æ˜¯æ— æ³•åœ¨ivaråŠpropertyä¸­éå†å‡ºæ¥)ã€‚</h6><ul>
<li>åˆ©ç”¨ class_addProperty å‡½æ•°è¿›è¡Œç±»å±æ€§çš„æ‰©å±•</li>
</ul>
<p>class_addProperty å‡½æ•°å¯ä»¥ä¸ºæˆ‘ä»¬ç”Ÿæˆç±»çš„propertyï¼Œ@propertyæ˜¯ç¼–è¯‘å™¨çš„æ ‡è¯†ç¬¦ï¼Œåœ¨æ™®é€šç±»ä¸­å¯ç”Ÿæˆpropertyã€ivarã€setMethodä¸getMethodï¼Œåœ¨æˆ‘çœ‹æ¥propertyçš„çœŸå®ä½œç”¨ç±»ä¼¼äºæ–¹æ³•çš„å£°æ˜ï¼Œåé¢æˆ‘ä¼šå†è°ˆä¸ºä»€ä¹ˆã€‚</p>
<p>åœ¨åˆ†ç±»ä¸­ä½¿ç”¨class_addPropertyå’Œæ™®é€šç±»ä¸€æ ·ï¼Œ åªèƒ½ç”Ÿæˆsetå’Œgetæ–¹æ³•çš„å£°æ˜ï¼Œæ— è®ºæœ‰æ²¡æœ‰è¢«å®ç°ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨ class_copyMethodList å‡½æ•°å¾—åˆ°propertyçš„listï¼Œå¦‚æœè¿™æ—¶å€™ä½ æƒ³å­˜å‚¨å±æ€§å€¼ï¼Œä½ ä¾ç„¶å¿…é¡»æ‰‹åŠ¨æˆ–åŠ¨æ€å®ç°é‚£äº›setå’Œgetæ–¹æ³•ï¼Œå¹¶ä¸”çœŸå®æ•°æ®çš„å­˜å‚¨ä¹Ÿå¿…é¡»ç”±ä½ è‡ªå·±æä¾›å®ç°ï¼Œæ¯”å¦‚å¯ä»¥ä½¿ç”¨å‰é¢æ‰€è¯´çš„objc_setAssociatedObject å‡½æ•°ã€‚</p>
<p>ç°åœ¨è¯´è¯´ä¸ºå•¥propertyåªæ˜¯ä¸€ä¸ªç±»ä¼¼å£°æ˜çš„ä½œç”¨å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥ä»è‹¹æœå¼€æºçš„ä»£ç ä¸­æ‰¾åˆ°è››ä¸é©¬è¿¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Class æ˜¯ä¸€ä¸ªæŒ‡å‘ç»“æ„ä½“ objc_class çš„æŒ‡é’ˆï¼Œè€Œæ­¤ç»“æ„ä½“çš„ç»“æ„å¦‚ä¸‹æ‰€ç¤º:</span><br><span class="line">struct objc_class : objc_object &#123;</span><br><span class="line">    // Class ISA;</span><br><span class="line">    Class superclass;  // æŒ‡å‘çˆ¶ç±»</span><br><span class="line">    cache_t cache;             // ç¼“å­˜æŒ‡é’ˆä¸vtable(æ²¡å­¦è¿‡C++,æ²¡äº†è§£è¿‡è™šå‡½æ•°è¿™äº›)ï¼ŒåŠ é€Ÿæ–¹æ³•çš„è°ƒç”¨</span><br><span class="line">    class_data_bits_t bits;   // çœŸæ­£ä¿å­˜å¯¹è±¡çš„ivarï¼Œpropertyä¸methodç­‰ä¿¡æ¯çš„åœ°æ–¹</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    åœ¨æºç ä¸­å¤§éƒ¨åˆ†æ—¶å€™è¡¨ç°ä¸ºå°†ç±»çš„å¤§éƒ¨åˆ†ä¿¡æ¯ä¿å­˜åœ¨ class_rw_t *rwæŒ‡é’ˆä¸­ï¼Œä¸è¿‡å†…éƒ¨ä¹Ÿæ˜¯è¿”å›bitsä¸­å¤„ç†åçš„ä¿¡æ¯</span><br><span class="line">    </span><br><span class="line">        class_rw_t *data() &#123; </span><br><span class="line">        return bits.data();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    åœ¨class_rw_tçš„ç»“æ„ä¸­ï¼Œç»“æ„å¦‚ä¸‹æ‰€ç¤º:</span><br><span class="line">    struct class_rw_t &#123;</span><br><span class="line">    // Be warned that Symbolication knows the layout of this structure.</span><br><span class="line">    uint32_t flags;   // ç±»çš„ä¿¡æ¯æ ‡è®°</span><br><span class="line">    uint32_t version; // å½“å‰è¿è¡Œæ—¶ç‰ˆæœ¬</span><br><span class="line"></span><br><span class="line">    const class_ro_t *ro;</span><br><span class="line"></span><br><span class="line">    method_array_t methods;</span><br><span class="line">    property_array_t properties;</span><br><span class="line">    protocol_array_t protocols;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°åœ¨class_rw_tçš„ç»“æ„ä¸­ï¼ŒåŒ…å«äº†å¦ä¸€ä¸ªååˆ†ç›¸ä¼¼çš„ const class_ro_t *ro æˆå‘˜å˜é‡ã€‚</p>
<p>è¿™ä¸ªæˆå‘˜å˜é‡ä¸ºä¸€ä¸ªä¸å¯ä¿®æ”¹å†…å®¹çš„ç»“æ„ä½“æŒ‡é’ˆï¼Œå…¶ä¸­å­˜å‚¨äº†ç±»åœ¨ç¼–è¯‘æ—¶å°±å·²ç»ç¡®å®šå¥½çš„ivarã€ propertyã€methodã€protocolç­‰ä¿¡æ¯ï¼Œåœ¨ç±»çš„åˆå§‹åŒ–æ—¶ä¼šé€šè¿‡ methodizeClass å‡½æ•°å°†å…¶å¤§éƒ¨åˆ†å†…å®¹éƒ½æ‹·è´åˆ° class_rw_t *rwä¸­ï¼Œå…¶ä¸­ ivar ä¸ä¼šè¢«æ‹·è´ï¼Œè¿™ä¹Ÿæ˜¯å‰é¢æ‰€è¯´çš„ä¸èƒ½åœ¨è¿è¡Œæ—¶ç»™å·²æœ‰çš„ç±»å¢åŠ  ivarçš„åŸå› ã€‚</p>
<p>åƒpropertyã€methodã€protocoléƒ½æ˜¯å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€æ·»åŠ çš„ï¼Œä¸”å­˜å‚¨åˆ° rw çš„ç»“æ„ä¸­å»ã€‚</p>
<p>å¥½åƒè¯´çš„æœ‰ç‚¹è·‘é¢˜äº†ï¼Œå’±ä»¬è¿˜æ˜¯ä¸€èµ·çœ‹çœ‹propertyåˆ°åº•å­˜å‚¨äº†ä»€ä¹ˆä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">struct property_t &#123;</span><br><span class="line">    const char *name;</span><br><span class="line">    const char *attributes;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œproppertyä¸­å¹¶æ²¡æœ‰å­˜å‚¨å¾ˆå¤šä¿¡æ¯ï¼Œåªæœ‰nameå’Œé…ç½®çš„å±æ€§ï¼Œä¹Ÿæ²¡æœ‰å®ç°å‡½æ•°çš„åœ°å€ï¼Œæ‰€ä»¥å‰é¢æˆ‘è¯´propertyçš„ä½œç”¨å…¶å®å’Œæ–¹æ³•çš„å£°æ˜æ˜¯å·®ä¸å¤šçš„ã€‚</p>
<p>å…³äºpropertyçš„å¥½å¤„ï¼Œä¹Ÿå°±æ˜¯åœ¨ä½¿ç”¨ç½‘ä¸Šjsonè½¬modelåº“æ—¶å¯ä»¥è¢«éå†åˆ°äº†ï¼Œä½†æ˜¯å¦‚æœä½ æ²¡æœ‰å®ç°setå’Œgetï¼Œé‚£ä¾ç„¶ä¼šå¯¼è‡´KVCçš„crashã€‚</p>
<ul>
<li>é€šè¿‡å†…éƒ¨åˆ›å»ºä¸€ä¸ªå…¶ä»–å¯¹è±¡(æ¯”å¦‚å­—å…¸),é€šè¿‡é‡å†™æœ¬å¯¹è±¡setå’Œgetæˆ–è€…æ¶ˆæ¯è½¬å‘ã€‚</li>
</ul>
<p>æœ€åä¸€ç§æ–¹æ³•ï¼Œä¹Ÿæ˜¯æ¯”è¾ƒå°‘ç”¨çš„æ–¹å¼ï¼Œè¯´èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæ¯”å¦‚å®šä¹‰ä¸€ä¸ªé™æ€çš„å­—å…¸å˜é‡ï¼Œç„¶åé€šè¿‡å®ç°interfaceä¸­å£°æ˜çš„setå’Œgetçš„å®ç°å¯¹è¿™ä¸ªå­—å…¸å˜é‡åšå­˜å–æ“ä½œï¼Œæˆ–è€…é€šè¿‡æ¶ˆæ¯è½¬å‘ä¸­çš„ (id)forwardingTargetForSelector:(SEL)aSelector æ–¹æ³•è¿”å›è¿™ä¸ªå­—å…¸å˜é‡ï¼Œä½†æ˜¯è¦æ³¨æ„æœ¬ç±»ä¸­æ²¡æœ‰å¯¹è½¬å‘åšè¿‡ä»€ä¹ˆäº‹ï¼Œä¸ç„¶è¿™ç§æ–¹æ³•ä¹Ÿæ˜¯ä¸é€‚ç”¨çš„ã€‚</p>
<h5 id="å¯¹ä¸Šæ–‡çš„æ€»ç»“"><a href="#å¯¹ä¸Šæ–‡çš„æ€»ç»“" class="headerlink" title="å¯¹ä¸Šæ–‡çš„æ€»ç»“"></a>å¯¹ä¸Šæ–‡çš„æ€»ç»“</h5><p>å…¶å®åˆšåˆšæ‰€æè¿°çš„ä¸‰ç§åˆ†ç±»ç­–ç•¥å¹¶ä¸æ˜¯å¾ˆä¸¥è°¨ï¼Œå› ä¸ºå…¶ä¸­å‡ ç§æ€»æ˜¯ä¼šæ­é…ç€ä½¿ç”¨ï¼Œæ‰€ä»¥åœ¨æ­¤ä¹Ÿè¦é€‰æ‹©ä¸€ä¸ªæ¯”è¾ƒå‡è¡¡çš„ç­–ç•¥æ¥å®ç°Categoryå±æ€§çš„ç»‘å®šã€‚</p>
<blockquote>
<p>å»ºè®®çš„ç­–ç•¥:</p>
<ol>
<li>ç”±äºæˆ‘ä»¬è‚¯å®šä¼šåœ¨interface ä¸­æä¾›ç”Ÿçš„propertyï¼ˆç”±äºæ²¡æœ‰åˆæˆå®ç°ä¸ivarï¼Œåœ¨æ­¤ç§°ä¸ºç”Ÿçš„ï¼‰ï¼Œæ‰€ä»¥è¿™æ ·å¯¹äºåœ¨å¤–éƒ¨è®¿é—®æ—¶å’Œæ™®é€špropertyç›¸åŒã€‚</li>
<li>ç”±äºç¼ºä¹çš„æ˜¯å®ç°ä»¥åŠå¯ä»¥å­˜å–çš„æ•°æ®é‡ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å®ç°è¿™äº›setä¸getã€‚</li>
<li>setä¸getçš„å®ç°å¯ä»¥é€šè¿‡ associatedObject è¿›è¡Œå¯¹å¯¹è±¡çš„å­˜å–æ“ä½œã€‚</li>
</ol>
<p>å¥½å¤„ï¼š è¿™ç§æ“ä½œç”±äºæä¾›äº†ç”Ÿçš„propertyï¼Œæ‰€ä»¥åœ¨ç¬¬ä¸‰æ–¹çš„jsonè½¬modelåº“éå†propertyæ—¶å¯ä»¥ç›´æ¥éå†åˆ°ï¼Œç”±äºä½ æ‰‹åŠ¨å®ç°äº†setä¸getï¼Œæ‰€ä»¥åœ¨éå†åçš„KVCèµ‹å€¼æ—¶ä¹Ÿèƒ½èµ·åˆ°ä½œç”¨ï¼Œä¿è¯äº†å’Œæ™®é€šæˆå‘˜å˜é‡çš„æ“ä½œä¸€è‡´æ€§ã€‚</p>
</blockquote>
<p>ä¼°è®¡ä¼šæœ‰äººçœ‹å®Œç»“è®ºåè§‰å¾—:â€œ æˆ‘æœ¬æ¥å°±æ˜¯è¿™ä¹ˆå†™çš„å•Šï¼Œä½ å†™è¿™ä¹ˆå¤šå­—åˆ°å¤´æ¥å¾—å‡ºçš„ç»“è®ºå’Œæˆ‘å¹³æ—¶å†™çš„ä¹Ÿä¸€æ ·ã€‚â€æ˜¯çš„ï¼Œæˆ‘åªèƒ½ç•¥è¡¨æŠ±æ­‰å•¦ğŸ˜ï¼</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>

  
	<section id="comments" class="comment">
	  <div id="disqus_thread">
	  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	  </div>
	</section>

	<script type="text/javascript">
	var disqus_shortname = 'junghsublog';
	(function(){
	  var dsq = document.createElement('script');
	  dsq.type = 'text/javascript';
	  dsq.async = true;
	  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	}());
	(function(){
	  var dsq = document.createElement('script');
	  dsq.type = 'text/javascript';
	  dsq.async = true;
	  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
	  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	}());
	</script>




    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2017 John Doe
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>